<%- include('../partials/header') %>

<div class="dashboard-layout">
  <main class="dashboard-main">
    <h1>Manage Administrators</h1>

    <!-- Form to Add a New Admin -->
    <h2>Add New Admin</h2>
    <form action="/admin/add-admin" method="POST" style="margin-bottom: 2rem;">
      <div style="display: flex; flex-wrap: wrap; gap: 1rem;">
        <div style="flex: 1; min-width: 200px;">
          <label for="name">Name</label>
          <input type="text" id="name" name="name" required>
        </div>
        <div style="flex: 1; min-width: 200px;">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" required>
        </div>
        <div style="flex: 1; min-width: 200px;">
          <label for="password">Password</label>
          <input type="password" id="password" name="password" required>
        </div>
      </div>
      <br>
      <button type="submit">Create Admin</button>
    </form>

    <hr>

    <!-- Table of Existing Admins -->
    <h2>Existing Admins</h2>
    <table style="width: 100%; border-collapse: collapse; margin-top: 20px;">
      <thead>
        <tr style="background-color: #f2f2f2;">
          <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Name</th>
          <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Email</th>
          <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Role</th>
          <th class="no-print" style="padding: 10px; border: 1px solid #ddd; text-align: left;">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% if(typeof admins !== 'undefined' && admins.length > 0) { %>
          <% admins.forEach(admin => { %>
            <tr>
              <td style="padding: 10px; border: 1px solid #ddd;"><%= admin.name %></td>
              <td style="padding: 10px; border: 1px solid #ddd;"><%= admin.email %></td>
              <td style="padding: 10px; border: 1px solid #ddd;"><%= admin.role %></td>
              <td class="no-print" style="padding: 10px; border: 1px solid #ddd; display: flex; gap: 10px; align-items: center;">
                <!-- Mail Link -->
                <a href="mailto:<%= admin.email %>" style="background-color: #007bff; color: white; padding: 5px 10px; border-radius: 5px; text-decoration: none;">Mail</a>
                
                <!-- Conditionally show Delete button -->
                <% if (admin.id != currentAdminId) { %>
                  <form action="/admin/delete-admin/<%= admin.id %>" method="POST" onsubmit="return confirm('Are you sure you want to delete this admin?');" style="margin: 0;">
                    <button type="submit" style="background-color: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer;">Delete</button>
                  </form>
                <% } else { %>
                  <span>(Current User)</span>
                <% } %>
              </td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr>
            <td colspan="4" style="padding: 10px; border: 1px solid #ddd; text-align: center;">No admin accounts found.</td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </main>

  <%- include('../partials/admin-sidebar') %>
</div>

<%- include('../partials/footer') %>

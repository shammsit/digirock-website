<%- include('../partials/header') %>

<!-- Main Content -->
<main>
  <h1>Welcome to My Website!</h1>
  <p>This is my introduction. It's great to have you here.</p>

  <div class="container" style="margin-top: 40px; text-align: center;">
    <h2>User Ratings</h2>
    <div style="width: 100%; max-width: 350px; margin: auto;">
      <canvas id="homepageRatingsChart"></canvas>
    </div>
  </div>

  <!-- START: NEW SOCIAL MEDIA SECTION -->
  <% if (typeof socialLinks !== 'undefined' && socialLinks.length > 0) { %>
    <div class="container" style="margin-top: 40px; text-align: center;">
      <h2>Follow Us</h2>
      <div class="social-links">
        <% socialLinks.forEach(link => { %>
          <a href="<%= link.link_url %>" target="_blank" rel="noopener noreferrer" title="<%= link.platform_name %>">
            <i data-lucide="<%= link.platform_key %>"></i>
          </a>
        <% }) %>
      </div>
    </div>
  <% } %>
  <!-- END: NEW SOCIAL MEDIA SECTION -->

</main>

<!-- Chart.js & Lucide Icons CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/lucide@latest"></script>

<!-- Ratings Chart Script -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    lucide.createIcons(); // Initialize Lucide icons

    const ctx = document.getElementById('homepageRatingsChart');
    const chartData = <%- chartData || '{}' %>;

    if (ctx && chartData && chartData.data && chartData.data.length > 0) {
      new Chart(ctx.getContext('2d'), {
        type: 'pie',
        data: {
          labels: chartData.labels,
          datasets: [{
            data: chartData.data,
            backgroundColor: [
              'rgba(255, 206, 86, 0.8)',
              'rgba(75, 192, 192, 0.8)',
              'rgba(255, 99, 132, 0.8)',
              'rgba(54, 162, 235, 0.8)',
              'rgba(153, 102, 255, 0.8)'
            ],
            borderColor: '#fff'
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'top',
            }
          }
        }
      });
    }

    // Sidebar toggle functionality
    const menuToggle = document.getElementById('menu-toggle');
    const sidebar = document.getElementById('left-sidebar');
    const sidebarClose = document.getElementById('sidebar-close');

    if (menuToggle && sidebar) {
      menuToggle.addEventListener('click', () => {
        sidebar.classList.toggle('collapsed');
      });
    }

    if (sidebarClose && sidebar) {
      sidebarClose.addEventListener('click', () => {
        sidebar.classList.add('collapsed');
      });
    }
  });
</script>

<%- include('../partials/footer') %>